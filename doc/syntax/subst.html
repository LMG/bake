<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Documentation of the bake-tookit</title>
<style type="text/css">
#rundrum {
  border-width:1px;
  border-style:dashed;
  border-color:blue;
  padding:0.2cm;
  text-align:justify; }
}
</style>
</head>
<body>
<h1>Variable substitution in Project.meta</h1>

<h3>Substituted variables</h3>
A variable can be defined with the --set command line option:
<pre id="rundrum"><code>bake ... --set MyVar=DEBUG</code></pre>
<p>
This can also be done by the Set keyword in Project.meta (see syntax documentation):
<p>
<table border="1">
  <tr><th bgcolor="#CCCCCC">Example</th><th bgcolor="#CCCCCC">Output</th></tr>
  <tr><td>Set WORLD, value: "world!"<br>CommandLine "echo hello $(WORLD)"</td> <td>hello world!</td></tr>
</table>
<p>
bake includes also some standard variables: 
<p>
<table border="1">
  <tr><th bgcolor="#CCCCCC">Variable</th><th bgcolor="#CCCCCC">Example</th></tr>
  <tr><td>$(MainConfigName)</td> <td>Debug</td></tr>
  <tr><td>$(MainProjectName)</td> <td>bootloader</td></tr>
  <tr><td>$(ConfigName)</td> <td>lib</td></tr>
  <tr><td>$(ProjectName)</td> <td>canDriver</td></tr>
  <tr><td>$(ProjectDir)</td> <td>C:/Root/MyProject</td></tr>
  <tr><td>$(MainProjectDir)</td> <td>C:/Root/Main</td></tr>
  <tr><td>$(OutputDir)</td> <td>build_lib_bootloader_Debug<br><i>output dir of the current config</i></td></tr>
  <tr><td>$(OutputDir,<i>projName</i>,<i>confName</i>)</td> <td><i>output dir of a specific config<br>relative to the current project</i></td></tr>
  <tr><td>$(ArtifactName)</td> <td>bootloader_1.0.elf</td></tr>
  <tr><td>$(ArtifactNameBase)</td> <td>bootloader_1.0</td></tr>
  <tr><td>$(Time)</td> <td>2012-12-24 20:00:00 +0200</td></tr>
  <tr><td>$(Hostname)</td> <td>MY_COMPUTER</td></tr>
  <tr><td>$(CPPPath)</td> <td>/usr/bin</td></tr>
  <tr><td>$(CPath)</td> <td>/usr/bin</td></tr>
  <tr><td>$(ASMPath)</td> <td>/usr/bin</td></tr>
  <tr><td>$(ArchiverPath)</td> <td>/usr/bin</td></tr>
  <tr><td>$(LinkerPath)</td> <td>/usr/bin</td></tr>
</table>
<br>
<table border="1">
  <tr><th bgcolor="#CCCCCC">Variable</th><th bgcolor="#CCCCCC">Windows</th><th bgcolor="#CCCCCC">Other</th><th bgcolor="#CCCCCC">Note</th></tr>
  <tr><td>$(/)</td> <td>\</td><td>/</td><td>Path delimiter</td></tr>
  <tr><td>$(:)</td> <td>;</td><td>:</td><td>Used for setting the PATH variable</td></tr>
</table>
<br>
<table border="1">
  <tr><th bgcolor="#CCCCCC">Expression</th><th bgcolor="#CCCCCC">Description</th></tr>
  <tr><td>IncludeDir "$(Roots)"</td> <td>Will be replaced by one or more<br>IncludeDir statements for all workspace roots.</td></tr>
</table>
<p>
Otherwise:
<p>
<table border="1">
  <tr><th bgcolor="#CCCCCC">Variable</th><th bgcolor="#CCCCCC">Example</th></tr>
  <tr><td>$(environment variable)</td> <td>whatever</td></tr>
</table>
<p>
If the environment variable does not exist, it will be substituted by an empty string.
<p>
Note, that variables in <b>Dependency</b> definitions are not allowed.

<h3>Equal variables in the main config</h3>

<table border="1">
  <tr><th bgcolor="#CCCCCC">Variable</th><th bgcolor="#CCCCCC">is equal to</th></tr>
  <tr><td>$(MainConfigName)</td> <td>$(ConfigName)</td></tr>
  <tr><td>$(MainProjectName)</td> <td>$(ProjectName)</td></tr>
</table>

<h3>Nested variables</h3>

Variables can be nested like this:
<pre id="rundrum"><code>$(OutputDir,$(TheProject),$(TheConfig))
$(ABC$(DEF)GH)</code></pre>

<h3>Auto-adjustment of paths to existing projects</h3>

If paths to other projects are needed, e.g. to "bootloaderUpdater", don't write a hard coded relative path like this:<br>
<font color="red">CommandLine "../bootloaderUpdater/tools/PrimaryBootloader2Include.exe</font><br>
bootloaderUpdater might be checked out into a different workspace root. If you write<br>
<font color="green">CommandLine "bootloaderUpdater/tools/PrimaryBootloader2Include.exe</font><br>
bake recognizes that the first part of the path is a valid project name and calculates the relative path to the project automatically.<br>

<h4>Special case:</h4>
If you have a directory in the current project, which has the same name as a valid project and you need to reference the directory, write<br>
<font color="green">IncludeDir "myProjectName/bootloaderUpdater/whatever"</font><br>
which will then adjusted to<br>
<font color="green">-I"bootloaderUpdater/whatever"</font><br>
instead of<br>
<font color="red">-I"../bootloaderUpdater/whatever" (depending of the location of the project bootloaderUpdater).</font>

<h4>Supported elements for auto-adjustment:</h4>
<ul>
    <li>IncludeDir
    <li>ExternalLibrary
    <li>ExternalLibrarySearchPath
    <li>UserLibrary
    <li>CommandLine
</ul>
<h3>Examples</h3>
<pre id="rundrum"><code>CommandLine "ddump -Ruv -y 0xFFFFF -o$(OutputDir)/$(ArtifactNameBase).bin $(OutputDir)/$(ArtifactName)"
ExternalLibrarySearchPath "$(PATH_TO_CYGWIN)/usr/local/lib"
IncludeDir "bspDma/include"</code></pre>



</body>

</html>